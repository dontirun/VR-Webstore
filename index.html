<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, World! - A-Frame</title>
    <meta name="description" content="Hello, World! - A-Frame">
    <script src="https://aframe.io/releases/0.3.2/aframe.min.js"></script>
    <script src="https://rawgit.com/bryik/aframe-vive-cursor-component/master/dist/aframe-vive-cursor-component.min.js"></script>
    <script src="https://rawgit.com/bryik/aframe-bmfont-text-component/master/dist/aframe-bmfont-text-component.min.js"></script>
    <script src="https://rawgit.com/IdeaSpaceVR/aframe-ui-modal-component/master/dist/aframe-ui-modal-component.min.js"></script>
  </head>


  <body>

    <a-scene id = "scene">

      <a-assets>
      <img id="woodfloor" src="/assets/textures/woodfloor.jpg">
      //bookshelf stuff
      <a-asset-item id="bookshelf-obj" src="/assets/models/Shelves/RetroRoomDivider.obj"></a-asset-item>
      <a-asset-item id="bookshelf-mtl" src="/assets/models/Shelves/RetroRoomDivider.mtl"></a-asset-item>
      //table stuff
      <a-asset-item id="table-obj" src="/assets/models/mesa.obj"></a-asset-item>
      <a-asset-item id="table-mtl" src="/assets/models/mesa.mtl"></a-asset-item>
      //cash register
      <a-asset-item id="register-obj" src="/assets/models/Register/SPA-check.obj"></a-asset-item>
      <a-asset-item id="register-mtl" src="/assets/models/Register/SPA-check.mtl"></a-asset-item>
      //arrow
      <a-asset-item id="arrow-obj" src="/assets/models/Arrow.obj"></a-asset-item>
      <a-asset-item id="arrow-mtl" src="/assets/models/Arrow.mtl"></a-asset-item>
      //rotate buttons
      <img id="rotLeftTex" src="/assets/textures/rotLeft.png">
      <img id="rotRightTex" src="/assets/textures/rotRight.png">
    </a-assets>
    
      <div></div>
      <a-entity bmfont-text="text:By: Arthur Dooner, Arun Donti, Robyn Domanico, Stephen Lafortune;width:360;color:#000000;letterSpacing:0" position="-4.35 1.68 5.52" rotation="0 90 0" scale="7 7 1" id="authorship"></a-entity>
      <a-entity bmfont-text="text:0:00;width:360;color:#ff0000;letterSpacing:0" position="-1.99 1.68 -6.15" rotation="0 0 0" scale="7 7 1" id="time"></a-entity>            
      <a-entity hand-controls="left" id="lhand" scale ="1 1 1"></a-entity>
      <a-entity hand-controls="right" id="rhand" scale ="1 1 1" vive-cursor></a-entity>

      <a-sky color="#C0DFF5" material="color:#bdddf4;shader:flat" scale="-1 1 1" position="0 0 0" geometry="primitive:sphere;radius:5000;segmentsWidth:64;segmentsHeight:20"></a-sky>

      <!-- Cursor for testing -->
   <!-- <a-entity position="0 1.6 0" camera="active:true;userHeight:1.6;near:0.01" wasd-controls="" rotation="-11.23 -3.21 0" look-controls="" aframe-injected="" data-aframe-inspector="default-camera" id="camera">
        <a-entity cursor="fuse: false"
            position="0 0 -1"
            geometry="primitive: ring"
            material="color: black; shader: flat">
        </a-entity>
      </a-entity>
      <a-entity ui-modal visible="false">
      </a-entity> -->

      // temp child for removeChild
      <a-plane  id="hidden" visible="false"></a-plane>

      <!-- Menu entities -->
      <a-entity position="1.61 1.09 -0.01" id="menu" rotation="0 -45 0" visible="true" scale="0.5 0.5 1">
        <a-entity bmfont-text="text: Item1; align: center;" position="-3 0 0"></a-entity>
        <a-plane width="3" height="0.5" color="gray" id="item1" position="0 1 0" material="" geometry="">
          <a-entity bmfont-text="text: Item1; align: left;" position="-1.5 0 0"></a-entity>
        </a-plane>
        <a-plane width="3" height="0.5" color="gray" id="item2" position="0 0.4 0" material="" geometry="">
          <a-entity bmfont-text="text: Item2; align: left;" position="-1.5 0 0"></a-entity>
        </a-plane>
        <a-plane width="3" height="0.5" color="gray" id="item3" position="0 -0.2 0" material="" geometry="">
          <a-entity bmfont-text="text: Item3; align: left;" position="-1.5 0 0"></a-entity>
        </a-plane>

        <!-- Arrows -->
        <a-entity position="1 -1 0" id="forwardArrow" obj-model="obj:#arrow-obj;mtl:#arrow-mtl" scale=".2 .2 .2" color="#804040" material=""></a-entity>
        <a-entity position="-1 -1 0" rotation="0 180 0" id="backArrow" obj-model="obj:#arrow-obj;mtl:#arrow-mtl" scale=".2 .2 .2" color="#804040" material=""></a-entity>
        <a-entity position="-2 1 0" rotation="0 0 90" id="upArrow" obj-model="obj:#arrow-obj;mtl:#arrow-mtl" scale=".2 .2 .2" color="#804040" material=""></a-entity>
      </a-entity>

      //clock
      <a-entity position="0 7.53 -5.71" scale="1 1 0.4" color="#000000" material="color:#000000" geometry="depth:1"></a-entity>
      //  walls
      <a-entity position="-4.62 5.1 0" id="left wall" rotation="0 0 0" scale="0.5 10 20" color="#ADD8E6" geometry="primitive:box" material="color:#ADD8E6"></a-entity>
      <a-entity position="4.61 5.1 0" id="right wall" rotation="0 0 0" scale="0.5 10 20" color="#ADD8E6" geometry="primitive:box" material="color:#ADD8E6" visible="true"></a-entity>
      <a-entity position="-0.64 5.1 6.25" id="back wall" scale="16 10 1" color="#ADD8E6" geometry="primitive:box" material="color:#ADD8E6"></a-entity>
      <a-entity position="-0.69 5.1 -6.68" id="front wall" scale="16 10 1" color="#ADD8E6" geometry="primitive:box" material="color:#ADD8E6" rotation="0 0 0" visible="true"></a-entity>
      

      <a-entity position="0 -0.1 0" scale="1 0 1" id="floor" geometry="primitive:box;radius:45;width:45;height:1;depth:45" material="src:#woodfloor"></a-entity>
      <a-entity position="-0.66 1.02 -0.94" id="register" obj-model="obj:#register-obj;mtl:#register-mtl" scale="0.25 0.25 0.25" color="#804040" material="" rotation="0 270 0"></a-entity>
      <a-entity position="0 1 -0.9" id="table1" obj-model="obj:#table-obj;mtl:#table-mtl" scale="0.01 0.02 0.01" color="#804040" material=""></a-entity>
      <a-entity position="3.92 0.1 -0.46" id="bookshelf1" obj-model="obj:#bookshelf-obj;mtl:#bookshelf-mtl" scale="0.05 0.02 0.02" color="#804040" material="" rotation="0 90 0"></a-entity>
      // table panels
      <a-plane position="-0.44 1.25 -1.45" rotation="-20 0 0" width="1.7" height="2"  material="color:#de21bd;opacity:0.5" geometry="primitive:box;width:1.7;height:2;depth:0.00" id="blPanel" scale="0.46 0.25 1.005" visible="true"></a-plane>
      <a-plane position="0.34 1.25 -1.45" rotation="-20 0 0" width="1.7" height="2" material="color:#b51802;opacity:0.5" geometry="primitive:box;width:1.7;height:2;depth:0.00" id="brPanel" scale="0.46 0.25 1.005" visible="true"></a-plane>
      <a-plane position="-0.44 1.71 -1.62" rotation="-20 0 0" width="1.7" height="2" material="color:#0335fc;opacity:0.5" geometry="primitive:box;width:1.7;height:2;depth:0.00" id="tlPanel" scale="0.46 0.25 1" visible="true"></a-plane>
      <a-plane position="0.34 1.71 -1.62" rotation="-20 0 0" width="1.7" height="2" material="color:#06f95b;opacity:0.5" geometry="primitive:box;width:1.7;height:2;depth:0.00" id="trPanel" scale="0.46 0.25 1" visible="true"></a-plane>

      // Rotate buttons
      <a-entity position="-0.49 0.88 -0.46" rotation="90 0 0" scale="0.2 0.2 0.2" id="rotRight" geometry="primitive:box;height:0.2" material="src:#rotRightTex" color="#63c9f2"></a-entity>
      <a-entity position="-0.69 0.88 -0.46" rotation="90 0 0" scale="0.2 0.2 0.2" id="rotLeft" geometry="primitive:box;height:0.2" material="src:#rotLeftTex" color="#63c9f2"></a-entity>
</body>
  <script>
  startTime();
    //var aframe = require('aframe');
    //var text =require('aframe-bmfont-text-component');

    var aScene = document.querySelector("a-scene");
    var assetList = document.querySelector("a-assets");

    var galleryOBJ = document.createElement("a-asset-item");
    galleryOBJ.setAttribute("id", "gallery-obj");
    galleryOBJ.setAttribute("src", "assets/models/IronMan.obj");
    assetList.appendChild(galleryOBJ);

    var galleryMTL = document.createElement("a-asset-item");
    galleryMTL.setAttribute("id", "gallery-mtl");
    galleryMTL.setAttribute("src", "assets/models/IronMan.mtl");
    assetList.appendChild(galleryMTL);

    // L/R rotate handlers
    document.querySelector('#rotLeft').addEventListener('click', function () {
      rotateLeft(currentObject);
    });
    document.querySelector('#rotRight').addEventListener('click', function () {
      rotateRight(currentObject);
    });

    // Left and Right rotation functions
    function rotateLeft(scene_element){
      var rot = scene_element.getAttribute("rotation");
      if(rot != null){
        var rot_y = rot.y % 360;
        var new_y = (rot_y - 90) % 360;

        scene_element.setAttribute("rotation", rot.x+" "+new_y+" "+rot.z);
      }
      else{
        scene_element.setAttribute("rotation", "0 270 0");
      }
    }

    function rotateRight(scene_element){
      var rot = scene_element.getAttribute("rotation");
      if(rot != null){
        var rot_y = rot.y % 360;
        var new_y = (rot_y + 90) % 360;

        scene_element.setAttribute("rotation", rot.x+" "+new_y+" "+rot.z);
      }
      else{
        scene_element.setAttribute("rotation", "0 90 0");
      }
    }

        // current materials on panels
    tlMaterial = "color:#0335fc;opacity:0.8";
    trMaterial = "color:#06f95b;opacity:0.8";
    brMaterial = "color:#b51802;opacity:0.8"
    blMaterial = "color:#de21bd;opacity:0.8"
    trashMaterial = "src:#trashcan;side:front;"
    var tempPlane2 =false;
    var child = false;
    var currentObject = document.getElementById("hidden");
// register sound onclick possibly, can't get onclick for the object to work'
  document.querySelector('#register').addEventListener('click', function () {
    });
  document.querySelector('#blPanel').addEventListener('click', function () {
    if(currentObject.id == "testPlane" ){
      aScene.removeChild(currentObject);
      document.querySelector('#blPanel').setAttribute("bmfont-text","text:");
      var galleryMesh = document.createElement("a-plane");
      galleryMesh.setAttribute("id", "hidden");
      galleryMesh.setAttribute("visible", "false");
      aScene.appendChild(galleryMesh);
      currentObject = document.getElementById("hidden");
    }
    else {
      aScene.removeChild(currentObject);
      document.querySelector('#tlPanel').setAttribute("bmfont-text","text:");
      document.querySelector('#trPanel').setAttribute("bmfont-text","text:");
      document.querySelector('#blPanel').setAttribute("bmfont-text","width:200;text: Click to Delete ; align:'left'");
      document.querySelector('#brPanel').setAttribute("bmfont-text","text:");
      var galleryMesh = document.createElement("a-entity");
      galleryMesh.setAttribute("id", "testPlane");
      galleryMesh.setAttribute("obj-model", "obj: #gallery-obj; mtl: #gallery-mtl");
      galleryMesh.setAttribute("position", "0.59 1.00 -.98");
      galleryMesh.setAttribute("scale", ".005 .005 .005");
      aScene.appendChild(galleryMesh);
      tempPlane2 = true;
      currentObject = document.getElementById("testPlane");
      }
    });
  document.querySelector('#tlPanel').addEventListener('click', function () {
    
    if(currentObject.id == "testPlane1" ){
      aScene.removeChild(currentObject);
      document.querySelector('#tlPanel').setAttribute("bmfont-text","text:");
      var galleryMesh = document.createElement("a-plane");
      galleryMesh.setAttribute("id", "hidden");
      galleryMesh.setAttribute("visible", "false");
      aScene.appendChild(galleryMesh);
      currentObject = document.getElementById("hidden");
    }
    else{
        aScene.removeChild(currentObject);
        document.querySelector('#tlPanel').setAttribute("bmfont-text","width:200;text: Click to Delete ; align:'left'");
        document.querySelector('#trPanel').setAttribute("bmfont-text","text:");
        document.querySelector('#blPanel').setAttribute("bmfont-text","text:");
        document.querySelector('#brPanel').setAttribute("bmfont-text","text:");
        
        var galleryMesh = document.createElement("a-entity");
        galleryMesh.setAttribute("id", "testPlane1");
        galleryMesh.setAttribute("material", "color:#0335fc;opacity:0.5");
        galleryMesh.setAttribute("position", "0.59 1.26 -.89");
        galleryMesh.setAttribute("geometry","box:sphere;width:1.7;height:2;depth:0.05");
        galleryMesh.setAttribute("scale", "0.25 0.25 .25");
        aScene.appendChild(galleryMesh);
        tempPlane2 = true;
        currentObject = document.getElementById("testPlane1");
    }
    
  });
    document.querySelector('#trPanel').addEventListener('click', function () {
    
    if(currentObject.id == "testPlane2" ){
      aScene.removeChild(currentObject);
      document.querySelector('#trPanel').setAttribute("bmfont-text","text:");
      var galleryMesh = document.createElement("a-plane");
      galleryMesh.setAttribute("id", "hidden");
      galleryMesh.setAttribute("visible", "false");
      aScene.appendChild(galleryMesh);
      currentObject = document.getElementById("hidden");
    }
    else{
        aScene.removeChild(currentObject);
        document.querySelector('#tlPanel').setAttribute("bmfont-text","text:");
        document.querySelector('#trPanel').setAttribute("bmfont-text","width:200;text: Click to Delete ; align:'left'");
        document.querySelector('#blPanel').setAttribute("bmfont-text","text:");
        document.querySelector('#brPanel').setAttribute("bmfont-text","text:");
        var galleryMesh = document.createElement("a-entity");
        galleryMesh.setAttribute("id", "testPlane2");
        galleryMesh.setAttribute("material", "color:#ff0000;opacity:0.5");
        galleryMesh.setAttribute("position", "0.59 1.26 -.89");
        galleryMesh.setAttribute("geometry","primitive:sphere;width:1.7;height:2;depth:0.05");
        galleryMesh.setAttribute("scale", "0.25 0.25 .25");
        aScene.appendChild(galleryMesh);
        tempPlane2 = true;
        currentObject = document.getElementById("testPlane2");
    }
  });
  document.querySelector('#brPanel').addEventListener('click', function () {
  if(currentObject.id == "testPlane3" ){
      aScene.removeChild(currentObject);
      document.querySelector('#brPanel').setAttribute("bmfont-text","text:");
      var galleryMesh = document.createElement("a-plane");
      galleryMesh.setAttribute("id", "hidden");
      galleryMesh.setAttribute("visible", "false");
      aScene.appendChild(galleryMesh);
      currentObject = document.getElementById("hidden");
    }
  else{
      aScene.removeChild(currentObject);
      document.querySelector('#tlPanel').setAttribute("bmfont-text","text:");
      document.querySelector('#trPanel').setAttribute("bmfont-text","text:");
      document.querySelector('#blPanel').setAttribute("bmfont-text","text:");
      document.querySelector('#brPanel').setAttribute("bmfont-text","width:200;text: Click to Delete ; align:'left'");
      var galleryMesh = document.createElement("a-entity");
      galleryMesh.setAttribute("id", "testPlane3");
      galleryMesh.setAttribute("material", "color:#00ff00;opacity:0.5");
      galleryMesh.setAttribute("position", "0.59 1.26 -.89");
      galleryMesh.setAttribute("geometry","primitive:ring;width:1.7;height:2;depth:0.05");
      galleryMesh.setAttribute("scale", "0.25 0.25 .25");
      aScene.appendChild(galleryMesh);
      tempPlane2 = true;
      currentObject = document.getElementById("testPlane3");
  }
});


// clock functions
function startTime() {
    var today = new Date();
    var h = today.getHours();
    var m = today.getMinutes();
    var s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    var timeVal = h + ":" + m + ":" + s;
    var stringTime = timeVal.toString();
    document.querySelector('#time').setAttribute("bmfont-text","text:"+stringTime+"; color:#ff0000; align:'left'");
    var t = setTimeout(startTime, 500);
}
function checkTime(i) {
    if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
    return i;
}
  </script>
</html>
